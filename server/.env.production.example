# ========================================
# Production Environment Variables
# Travel Agent P - Backend
# ========================================
# CRITICAL: DO NOT commit this file with real values!
# Copy to .env and fill in production secrets
# ========================================

# ============= Application Settings =============
SECRET_KEY=your-super-secret-production-key-change-this
FLASK_ENV=production
DEBUG=False

# ============= PostgreSQL Database =============
# Option 1: Full connection URL (recommended for managed services)
DATABASE_URL=postgresql+psycopg2://username:password@host:5432/dbname?sslmode=require

# Option 2: Individual components (for Docker Compose)
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USERNAME=postgres
POSTGRES_PASSWORD=your-postgres-password
POSTGRES_DBNAME=travel_agent_db

# ============= MongoDB Database =============
# MongoDB Atlas (Cloud) - REQUIRED
# Get connection string from MongoDB Atlas dashboard
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/travelplanner_db?retryWrites=true&w=majority
MONGODB_DB_NAME=travelplanner_db

# MongoDB Connection Pool Settings
MONGODB_MAX_POOL_SIZE=50
MONGODB_MIN_POOL_SIZE=10
MONGODB_SERVER_SELECTION_TIMEOUT_MS=5000
MONGODB_CONNECT_TIMEOUT_MS=10000

# MongoDB Collections
MONGODB_POI_COLLECTION=poi
MONGODB_ITINERARY_COLLECTION=itineraries
MONGODB_REVIEW_COLLECTION=reviews

# ============= Redis Cache & Queue =============
# Option 1: Full URL
REDIS_URL=redis://redis:6379/0

# Option 2: Components
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# ============= Celery Configuration =============
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/1

# Celery Result Backend & Worker Timeout Settings
# NOTE: These are INDEPENDENT from cache TTL and do NOT affect Redis cache expiration
CELERY_RESULT_EXPIRES=3600
CELERY_SOCKET_CONNECT_TIMEOUT=10
CELERY_SOCKET_TIMEOUT=30
CELERY_SOCKET_MAX_RETRIES=5
CELERY_PREFETCH_MULTIPLIER=1
CELERY_MAX_TASKS_PER_CHILD=100
CELERY_WORKER_POOL=prefork

# ============= Email Configuration (Gmail) =============
# Get App Password from: https://myaccount.google.com/apppasswords
MAIL_SERVER=smtp.gmail.com
MAIL_PORT=587
MAIL_USE_TLS=True
MAIL_USERNAME=your-email@gmail.com
MAIL_PASSWORD=your-16-char-app-password
MAIL_DEFAULT_SENDER=your-email@gmail.com

# Download serviceAccount.json from Firebase Console > Project Settings > Service Accounts
FIREBASE_CREDENTIALS_PATH=secrets/serviceAccount.json
FIREBASE_STORAGE_BUCKET=your-project.firebasestorage.appsdk.json
FIREBASE_STORAGE_BUCKET=your-project.appspot.com

# ============= Google APIs =============
GOOGLE_PLACES_API_KEY=your-google-places-api-key
GOOGLE_CLIENT_ID=your-oauth-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-oauth-client-secret

# ============= TripAdvisor AConfiguration =============
LLM_PROVIDER=groq

# Groq LLM (FREE - Recommended)
GROQ_API_KEY=gsk_your_free_groq_api_key
# Best model options:
# - openai/gpt-oss-120b (120B params, 128k context, best for itineraries)
# - llama-3.3-70b-versatile (stable, versatile)
# - llama-3.1-8b-instant (faster, cheaper)
# - mixtral-8x7b-32768 (larger context window)
GROQ_MODEL=openai/gpt-oss-120b

# HuggingFace (Alternative)
# LLM_PROVIDER=huggingface
# HUGGINGFACE_API_KEY=hf_your_api_key
# HUGGINGFACE_MODEL=meta-llama/Llama-3.2-3B-Instruct
# LANGCHAIN_MAX_RETRIES=3
# LANGCHAIN_TIMEOUT=120

# OpenAI (Paid Alternativeocker

# === Docker/Self-hosted ES ===
ELASTICSEARCH_URL=http://elasticsearch:9200
ELASTICSEARCH_USERNAME=elastic
ELASTICSEARCH_PASSWORD=changeme
# ELASTICSEARCH_API_KEY=  # Optional: use API key instead of username/password

# === Elastic Cloud ===
# ELASTICSEARCH_CLOUD_ID=your-deployment-name:base64-encoded-string
# ELASTICSEARCH_CLOUD_API_KEY=your-cloud-api-key

# Optional settings
ELASTICSEARCH_POI_INDEX=pois
ELASTICSEARCH_CONFIG_FILE_PATH=app/repo/es/mappings/poi_index_mapping.json
ELASTICSEARCH_TIMEOUT=30
ELASTICSEARCH_MAX_RETRIES=3
ELASTICSEARCH_VERIFY_CERTS=false)
# LLM_PROVIDER=openai
# OPENAI_API_KEY=sk-your-openai-api-key

# ============= Elasticsearch (Optional) =============
ELASTICSEARCH_ENABLED=True
ELASTICSEARCH_URL=http://elasticsearch:9200
ELASTICSEARCH_USERNAME=elastic
ELASTICSEARKEY_PREFIX=travel_agent:rate_limit

# Auth endpoints
RATE_LIMIT_LOGIN=5
RATE_LIMIT_LOGIN_WINDOW=30
RATE_LIMIT_REGISTER=5
RATE_LIMIT_REGISTER_WINDOW=60
RATE_LIMIT_RESET_PASSWORD=5
RATE_LIMIT_RESET_PASSWORD_WINDOW=60

# API endpoints
RATE_LIMIT_PLAN_CREATION=5
RATE_LIMIT_PLAN_CREATION_WINDOW=3600

# Autocomplete endpoint

# ============= Rate Limiting =============
RATE_LIMIT_ENABLED=True
RATE_LIMIT_LOGIN=5
RATE_LIMIT_LOGIN_WINDOW=300
RATE_LIMIT_REGISTER=3
RATE_LIMIT_REGISTER_WINDOW=3600
RATE_LIMIT_RESET_PASSWORD=3
RATE_LIMIT_RESET_PASSWORD_WINDOW=3600

# Autocomplete API Protection - Negative Query Cache
NEGATIVE_CACHE_ENABLED=True
NEGATIVE_CACHE_TTL=900
RATE_LIMIT_AUTOCOMPLETE_WINDOW=60

# ============= Cache Configuration =============
CACHE_ENABLED=True
CACHE_DEFAULT_TTL=300
CACHE_USER_PROFILE_TTL=600
CACHE_POI_DETAILS_TTL=3600
NEGATIVE_CACHE_TTL=900
NEGATIVE_CACHE_ENABLED=True

# ============= Feature Flags =============
FEATURE_PLAN_AI=true
MOCK_POI_ENABLED=false

# ============= Monitoring & Logging =============
# Sentry (Optional)
# Set high to effectively disable quota checking
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# Log Level
LOG_LEVEL=INFO

# ============= CORS Settings =============
CORS_ORIGINS=https://travelagentp.web.app,https://travelagentp.firebaseapp.com

# ============= Google API Quotas =============
GOOGLE_API_DAILY_QUOTA=10000
GOOGLE_API_QUOTA_ALERT_THRESHOLD=0.9

# ============= Security =============
# Production mode: Enforce HTTPS, secure cookies
SESSION_COOKIE_SECURE=True
SESSION_COOKIE_HTTPONLY=True
SESSION_COOKIE_SAMESITE=Lax
