# ==============================================================================
# TRAVEL AGENT P - ENVIRONMENT VARIABLES
# ==============================================================================
# Copy this file to .env and fill in your actual values
# NEVER commit .env to version control!
# ==============================================================================

# ------------------------------------------------------------------------------
# APPLICATION SETTINGS
# ------------------------------------------------------------------------------
FLASK_APP=run.py
FLASK_ENV=development
# Options: development, staging, production
SECRET_KEY=your-super-secret-key-change-this-in-production
DEBUG=True

# Server Configuration
HOST=0.0.0.0
PORT=5000

# API Configuration
API_TITLE="Travel Agent P API"
API_VERSION=1.0.0
API_PREFIX=/api

# Timezone & Language
DEFAULT_TIMEZONE=Asia/Ho_Chi_Minh
DEFAULT_LANGUAGE=vi

# ------------------------------------------------------------------------------
# DATABASE - POSTGRESQL
# ------------------------------------------------------------------------------
# PostgreSQL for relational data: users, roles, tokens, bookings
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=travel_agent_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your_postgres_password

# SQLAlchemy Database URL (constructed from above or override)
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# Connection Pool Settings
SQLALCHEMY_POOL_SIZE=10
SQLALCHEMY_MAX_OVERFLOW=20
SQLALCHEMY_POOL_TIMEOUT=30
SQLALCHEMY_POOL_RECYCLE=3600
SQLALCHEMY_ECHO=False

# ------------------------------------------------------------------------------
# DATABASE - MONGODB
# ------------------------------------------------------------------------------
# MongoDB for document data: POI, itineraries, reviews
MONGODB_URI=mongodb://localhost:27017/travel_agent_poi
MONGODB_DB_NAME=travel_agent_poi

# MongoDB Connection Options
MONGODB_MAX_POOL_SIZE=50
MONGODB_MIN_POOL_SIZE=10
MONGODB_SERVER_SELECTION_TIMEOUT_MS=5000
MONGODB_CONNECT_TIMEOUT_MS=10000

# MongoDB Collections
MONGODB_POI_COLLECTION=poi
MONGODB_ITINERARY_COLLECTION=itineraries
MONGODB_REVIEW_COLLECTION=reviews

# ------------------------------------------------------------------------------
# DATABASE - REDIS
# ------------------------------------------------------------------------------
# Redis for: JWT blacklist, rate limiting, cache, Celery message broker
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
REDIS_DECODE_RESPONSES=True

# Redis Connection Pool
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# Redis TTL Settings (seconds)
REDIS_JWT_BLACKLIST_TTL=3600
REDIS_CACHE_DEFAULT_TTL=300
REDIS_SESSION_TTL=86400

# ------------------------------------------------------------------------------
# CACHE CONFIGURATION
# ------------------------------------------------------------------------------
# Cache backend: redis (recommended) or memory
CACHE_TYPE=redis
CACHE_ENABLED=True

# Cache TTL by Type (seconds)
CACHE_POI_DETAILS_TTL=3600
CACHE_POI_SEARCH_TTL=600
CACHE_USER_PROFILE_TTL=300
CACHE_ITINERARY_TTL=1800

# Cache Key Prefixes
CACHE_KEY_PREFIX=travel_agent:cache
CACHE_POI_PREFIX=poi
CACHE_SEARCH_PREFIX=search
CACHE_USER_PREFIX=user

# ------------------------------------------------------------------------------
# RATE LIMITING
# ------------------------------------------------------------------------------
# Rate limit storage: redis (recommended)
RATE_LIMIT_ENABLED=True
RATE_LIMIT_STORAGE_URL=redis://${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# Rate Limit Rules (format: {limit}/{window_seconds})
# Auth endpoints
RATE_LIMIT_LOGIN=5/300
RATE_LIMIT_REGISTER=3/3600
RATE_LIMIT_RESET_PASSWORD=3/3600
RATE_LIMIT_VERIFY_EMAIL=10/3600

# API endpoints
RATE_LIMIT_POI_SEARCH=60/60
RATE_LIMIT_ITINERARY_GENERATE=10/3600
RATE_LIMIT_DEFAULT=100/60

# Rate Limit Key Prefix
RATE_LIMIT_KEY_PREFIX=travel_agent:rate_limit

# ------------------------------------------------------------------------------
# JWT (JSON WEB TOKEN)
# ------------------------------------------------------------------------------
# JWT Secret (CHANGE THIS IN PRODUCTION!)
JWT_SECRET_KEY=your-jwt-secret-key-change-this-in-production

# JWT Token Expiration
JWT_ACCESS_TOKEN_EXPIRES=3600
JWT_REFRESH_TOKEN_EXPIRES=2592000

# JWT Algorithm
JWT_ALGORITHM=HS256

# JWT Token Location
JWT_TOKEN_LOCATION=["headers"]
JWT_HEADER_NAME=Authorization
JWT_HEADER_TYPE=Bearer

# JWT Blacklist
JWT_BLACKLIST_ENABLED=True
JWT_BLACKLIST_TOKEN_CHECKS=["access", "refresh"]

# ------------------------------------------------------------------------------
# CELERY (ASYNC TASK QUEUE)
# ------------------------------------------------------------------------------
# Celery Broker: Redis
CELERY_BROKER_URL=redis://${REDIS_HOST}:${REDIS_PORT}/1

# Celery Result Backend: Redis
CELERY_RESULT_BACKEND=redis://${REDIS_HOST}:${REDIS_PORT}/2

# Celery Configuration
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=["json"]
CELERY_TIMEZONE=Asia/Ho_Chi_Minh
CELERY_ENABLE_UTC=True

# Celery Task Time Limits (seconds)
CELERY_TASK_SOFT_TIME_LIMIT=300
CELERY_TASK_TIME_LIMIT=600

# Celery Worker Concurrency
CELERY_WORKER_CONCURRENCY=4
CELERY_WORKER_PREFETCH_MULTIPLIER=4

# ------------------------------------------------------------------------------
# EMAIL CONFIGURATION
# ------------------------------------------------------------------------------
# Email Provider: SMTP
MAIL_SERVER=smtp.gmail.com
MAIL_PORT=587
MAIL_USE_TLS=True
MAIL_USE_SSL=False
MAIL_USERNAME=your-email@gmail.com
MAIL_PASSWORD=your-email-app-password
MAIL_DEFAULT_SENDER=noreply@travelagentp.com

# Email Templates
MAIL_SUBJECT_PREFIX=[Travel Agent P]

# Email Sending Method: celery (async) or direct (sync)
MAIL_SEND_METHOD=celery

# ------------------------------------------------------------------------------
# FIREBASE STORAGE
# ------------------------------------------------------------------------------
# Firebase for storing images, avatars, documents
FIREBASE_CREDENTIALS_PATH=secrets/firebase-adminsdk.json

# Firebase Storage Bucket
FIREBASE_STORAGE_BUCKET=travel-agent-p.appspot.com

# Firebase Storage Folders
FIREBASE_AVATAR_FOLDER=avatars
FIREBASE_POI_IMAGE_FOLDER=poi_images
FIREBASE_ITINERARY_THUMB_FOLDER=itinerary_thumbnails

# ------------------------------------------------------------------------------
# AI/ML - HUGGINGFACE
# ------------------------------------------------------------------------------
# HuggingFace API Token
HUGGINGFACE_API_KEY=hf_your_api_token_here

# HuggingFace Model for Embeddings
HUGGINGFACE_EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
HUGGINGFACE_EMBEDDING_DIMENSION=384

# HuggingFace Model Cache Directory
HUGGINGFACE_CACHE_DIR=./cache/huggingface

# ------------------------------------------------------------------------------
# AI/ML - LANGCHAIN
# ------------------------------------------------------------------------------
# LangChain LLM Provider: openai, huggingface, azure_openai
LANGCHAIN_LLM_PROVIDER=openai

# OpenAI Configuration (if using OpenAI)
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4-turbo
OPENAI_TEMPERATURE=0.7
OPENAI_MAX_TOKENS=2000

# LangChain Settings
LANGCHAIN_VERBOSE=True
LANGCHAIN_CACHE_ENABLED=True

# Itinerary Generation Settings
ITINERARY_MAX_GENERATION_TIME=30
ITINERARY_MIN_POI_PER_DAY=3
ITINERARY_MAX_POI_PER_DAY=5

# ------------------------------------------------------------------------------
# ELASTICSEARCH (OPTIONAL)
# ------------------------------------------------------------------------------
# Elasticsearch for full-text search, fuzzy matching
ELASTICSEARCH_ENABLED=False
ELASTICSEARCH_URL=http://localhost:9200
ELASTICSEARCH_USERNAME=elastic
ELASTICSEARCH_PASSWORD=your_elasticsearch_password

# Elasticsearch Index Settings
ELASTICSEARCH_POI_INDEX=poi_index
ELASTICSEARCH_ANALYZER=vietnamese
ELASTICSEARCH_MAX_RESULTS=100

# Elasticsearch Connection
ELASTICSEARCH_TIMEOUT=30
ELASTICSEARCH_MAX_RETRIES=3

# ------------------------------------------------------------------------------
# EXTERNAL APIs
# ------------------------------------------------------------------------------
# Google Places API (for POI data enrichment)
GOOGLE_PLACES_API_KEY=your-google-places-api-key

# Google Maps API (for geocoding, directions)
GOOGLE_MAPS_API_KEY=your-google-maps-api-key

# Weather API (for travel recommendations)
WEATHER_API_KEY=your-weather-api-key
WEATHER_API_URL=https://api.openweathermap.org/data/2.5

# Exchange Rate API (for currency conversion)
EXCHANGE_RATE_API_KEY=your-exchange-rate-api-key
EXCHANGE_RATE_API_URL=https://api.exchangerate-api.com/v4

# ------------------------------------------------------------------------------
# OAUTH PROVIDERS
# ------------------------------------------------------------------------------
# Google OAuth
# ======================
# Get these from: https://console.cloud.google.com/
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret

# ======================
# ðŸ”¹ Redis Configuration
# ======================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=1
# REDIS_PASSWORD=your_password_here  # Uncomment if Redis has password

# ======================
# ðŸ”¹ Rate Limiting Configuration
# ======================
RATE_LIMIT_ENABLED=True
RATE_LIMIT_LOGIN=5                    # 5 attempts per window
RATE_LIMIT_LOGIN_WINDOW=300           # 5 minutes
RATE_LIMIT_REGISTER=3                 # 3 attempts per window
# Google OAuth
GOOGLE_CLIENT_ID=your-google-oauth-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-oauth-client-secret
GOOGLE_REDIRECT_URI=http://localhost:5000/api/auth/google/callback

# Facebook OAuth
FACEBOOK_CLIENT_ID=your-facebook-app-id
FACEBOOK_CLIENT_SECRET=your-facebook-app-secret
FACEBOOK_REDIRECT_URI=http://localhost:5000/api/auth/facebook/callback

# ------------------------------------------------------------------------------
# CORS (CROSS-ORIGIN RESOURCE SHARING)
# ------------------------------------------------------------------------------
# CORS Allowed Origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
CORS_ALLOW_CREDENTIALS=True
CORS_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS
CORS_ALLOW_HEADERS=Content-Type,Authorization,X-Requested-With

# ------------------------------------------------------------------------------
# LOGGING
# ------------------------------------------------------------------------------
# Log Level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log File
LOG_FILE=logs/app.log
LOG_MAX_BYTES=10485760
LOG_BACKUP_COUNT=5

# Log Format
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s

# Enable SQL Query Logging
SQL_LOG_ENABLED=False

# ------------------------------------------------------------------------------
# SECURITY
# ------------------------------------------------------------------------------
# Password Hashing
BCRYPT_LOG_ROUNDS=12

# CSRF Protection
WTF_CSRF_ENABLED=True
WTF_CSRF_TIME_LIMIT=3600

# Session Security
SESSION_COOKIE_SECURE=False
SESSION_COOKIE_HTTPONLY=True
SESSION_COOKIE_SAMESITE=Lax

# Content Security Policy
CSP_ENABLED=False

# ------------------------------------------------------------------------------
# MONITORING & ANALYTICS
# ------------------------------------------------------------------------------
# Sentry (Error Tracking)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# Google Analytics
GA_TRACKING_ID=

# Application Insights (Azure)
APPINSIGHTS_INSTRUMENTATION_KEY=

# ------------------------------------------------------------------------------
# PERFORMANCE
# ------------------------------------------------------------------------------
# Request Timeout (seconds)
REQUEST_TIMEOUT=30

# Max Content Length (bytes) - 16MB
MAX_CONTENT_LENGTH=16777216

# Pagination Defaults
DEFAULT_PAGE_SIZE=20
MAX_PAGE_SIZE=100

# Background Job Retry
MAX_RETRY_ATTEMPTS=3
RETRY_BACKOFF_SECONDS=5

# ------------------------------------------------------------------------------
# FEATURE FLAGS
# ------------------------------------------------------------------------------
# Enable/Disable Features
FEATURE_ELASTICSEARCH=False
FEATURE_AI_ITINERARY=True
FEATURE_SOCIAL_SHARE=True
FEATURE_BOOKING=False
FEATURE_PAYMENT=False
FEATURE_REVIEWS=False

# Maintenance Mode
MAINTENANCE_MODE=False

# ------------------------------------------------------------------------------
# DEVELOPMENT TOOLS
# ------------------------------------------------------------------------------
# Flask Debug Toolbar
DEBUG_TOOLBAR_ENABLED=False

# Swagger/OpenAPI Documentation
SWAGGER_ENABLED=True
SWAGGER_URL=/api/docs

# API Key for Admin Operations
ADMIN_API_KEY=your-admin-api-key-for-cli-operations
